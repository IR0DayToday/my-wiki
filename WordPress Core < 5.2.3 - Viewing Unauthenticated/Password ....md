اطلاعات مربوط به آسیب‌پذیری "WordPress Core < 5.2.3 - Viewing Unauthenticated/Password..." که به طور خاص به "Viewing Unauthenticated/Password/Private Posts" اشاره دارد، در اینجا توضیح داده شده است:

**CVE مرتبط:**

*   **CVE-2019-17671**: این آسیب‌پذیری به WordPress Core نسخه‌های کمتر از 5.2.3 مربوط می‌شود و به کاربران غیرمجاز یا بدون احراز هویت (Unauthenticated) اجازه می‌دهد تا محتوای پست‌های محافظت شده با رمز عبور (Password-Protected) و پست‌های خصوصی (Private Posts) را مشاهده کنند.

**شرح آسیب‌پذیری (Tricks/How it works):**

این آسیب‌پذیری ناشی از نحوه مدیریت پیش‌نمایش پست‌ها (Post Previews) و کنترل دسترسی در نسخه‌های قدیمی‌تر وردپرس است. به طور خلاصه، مهاجم می‌تواند با دستکاری پارامترهای URL یا درخواست‌های HTTP، پیش‌نمایش پست‌هایی را که قرار است فقط برای نویسنده یا کاربران مجاز قابل مشاهده باشد، مشاهده کند.

*   **پست‌های محافظت شده با رمز عبور:** معمولاً، برای مشاهده این پست‌ها نیاز به وارد کردن رمز عبور است. اما با این آسیب‌پذیری، مهاجم می‌توانست با ارسال یک درخواست خاص (معمولاً شامل یک پارامتر `post_ID` و گاهی اوقات پارامتر `post_type=any` یا `post_status=any` در URL یا کوکی‌ها)، پیش‌نمایش پست را بدون نیاز به رمز عبور مشاهده کند. این پیش‌نمایش شامل بخش قابل توجهی از محتوای پست بود.
*   **پست‌های خصوصی:** این پست‌ها فقط برای کاربران دارای نقش‌های خاص (مانند مدیر یا ویرایشگر) قابل مشاهده هستند. با بهره‌برداری از این آسیب‌پذیری، مهاجم می‌توانست با دستکاری مشابهی در URL یا درخواست، پیش‌نمایش این پست‌های خصوصی را نیز مشاهده کند.

**مراحل کلی بهره‌برداری (Exploitation Concept):**

1.  **شناسایی هدف:** مهاجم باید وب‌سایت وردپرسی با نسخه آسیب‌پذیر (< 5.2.3) را شناسایی کند.
2.  **یافتن ID پست:** مهاجم باید ID پست‌های هدف (پست‌های خصوصی یا محافظت شده با رمز عبور) را به دست آورد. این کار می‌تواند از طریق حدس زدن، مشاهده لینک‌ها در بخش‌های عمومی سایت، یا اسکن کردن سایت انجام شود.
3.  **ساخت درخواست مخرب:** مهاجم یک درخواست HTTP (معمولاً GET) به سایت وردپرس می‌فرستد که شامل ID پست هدف و پارامترهای خاصی برای فعال کردن حالت پیش‌نمایش می‌شود، بدون اینکه رمز عبور را ارائه دهد یا احراز هویت شده باشد.
    *   مثال تقریبی (نه کد دقیق، فقط برای درک مفهوم):
        `http://example.com/?p=<POST_ID>&preview=true`
        یا پیچیده‌تر با پارامترهای کوکی یا سایر هدرها.

**ابزارهای لازم (Tools):**

*   **مرورگر وب (با قابلیت Inspect Element):** برای مشاهده سورس کد صفحات و کوکی‌ها و همچنین ساخت دستی URLها.
*   **پراکسی‌های HTTP (مانند Burp Suite یا OWASP ZAP):** این ابزارها برای رهگیری، مشاهده و دستکاری درخواست‌ها و پاسخ‌های HTTP بسیار مفید هستند. مهاجم می‌تواند درخواست‌های خود را تغییر دهد تا آسیب‌پذیری را فعال کند.
*   **اسکنرهای آسیب‌پذیری وردپرس:** ابزارهایی مانند WPScan می‌توانند به شناسایی نسخه وردپرس و گاهی اوقات حتی نشانه‌هایی از آسیب‌پذیری‌های شناخته شده کمک کنند. (اگرچه WPScan معمولاً مستقیماً این اکسپلویت را اجرا نمی‌کند، اما در فاز شناسایی مفید است).
*   **Exploit Frameworks (مانند Metasploit - در صورت وجود ماژول):** برای آسیب‌پذیری‌های شناخته شده و رایج، ممکن است ماژول‌های آماده در فریم‌ورک‌هایی مانند Metasploit وجود داشته باشد که کار بهره‌برداری را ساده‌تر می‌کنند. (برای CVE-2019-17671، ماژولی در Metasploit موجود است).

**پیشگیری و راه حل (برای مدیران سایت):**

*   **به‌روزرسانی فوری وردپرس:** مهمترین و مؤثرترین راه حل این است که وردپرس خود را به آخرین نسخه (یا حداقل نسخه‌های 5.2.3 و بالاتر) به‌روزرسانی کنید. این آسیب‌پذیری در نسخه‌های جدیدتر رفع شده است.
*   **استفاده از فایروال‌های برنامه وب (WAF):** یک WAF می‌تواند با فیلتر کردن درخواست‌های مخرب، از تلاش‌ها برای بهره‌برداری از این آسیب‌پذیری و سایر آسیب‌پذیری‌های شناخته شده جلوگیری کند.
*   **محدود کردن دسترسی به فایل‌های حیاتی:** اطمینان حاصل کنید که فایل‌های پیکربندی و حیاتی وردپرس دارای مجوزهای دسترسی صحیح هستند.

به عنوان یک هکر کلاه سفید، هدف شما باید کمک به مدیران وب‌سایت‌ها برای شناسایی و رفع این نقاط ضعف باشد تا امنیت آن‌ها افزایش یابد.